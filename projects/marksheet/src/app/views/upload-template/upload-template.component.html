<div class="fade-in">
  <c-card>
    <c-card-header style="background-color:#f0f3f5">
      <h4><b>Upload Template</b></h4>
    </c-card-header>
    <c-card-body>
      <c-nav variant="tabs">
        <a [active]="true" [cTabContent]="tabContent" [routerLink] [tabPaneIdx]="0" cNavLink>Template Entry</a>
        <a [cTabContent]="tabContent" [routerLink] [tabPaneIdx]="1" cNavLink> Delete Template</a>
      </c-nav>
      <c-tab-content #tabContent="cTabContent">
        <c-tab-pane class="p-3">
          <c-card-body>
            <form cForm [formGroup]="UploadTemplateForm" (keydown.enter)="$event.preventDefault()"
                  (ngSubmit)="OnDownloadFile()">
              <c-row>
                <c-col [md]="4">
                  <label for="Batch_Name">Batch:</label>
                  <div class="ng-autocomplete" style="width: 100%;">
                    <ng-autocomplete
                      id="Batch_Name"
                      [data]="Batchs" [searchKeyword]="Batchkeyword"
                      (selected)='selectBatch($event)' (inputChanged)='onChangeSearch($event)'
                      (inputFocused)='onFocused($event)' [itemTemplate]="batTemplate"
                      [notFoundTemplate]="notFoundTemplate" placeholder="Select Batch">
                    </ng-autocomplete>
                    <ng-template #batTemplate let-bat>
                      <a [innerHTML]="bat.Batch_Name"></a>
                    </ng-template>
                    <ng-template #notFoundTemplate let-notFound>
                      <div [innerHTML]="notFound"></div>
                    </ng-template>
                  </div>
                </c-col>
                <c-col [md]="2">
                  <label for="userexam">User Exam:</label>
                  <select
                    id="userexam"
                    [(ngModel)]="SelectedUserExam" formControlName="userexam"
                    class="form-control" (change)="onChangeUserExamSelect()">
                    <option selected>--Select User Exam--</option>
                    <option *ngFor="let user of namesubject" [ngValue]="user">
                      {{ user.Userexamname }}</option>
                  </select>
                  <span
                    *ngIf="UploadTemplateForm.get('userexam')?.invalid && UploadTemplateForm.get('userexam')?.touched"
                    class="text-danger">user exam is required</span>
                </c-col>
                <c-col [md]="2">
                  <div style="padding-top: 25px;">
                    <button cButton type="submit" [disabled]="UploadTemplateForm.invalid"
                            class="btn btn-info">
                      <!--                          <i style="border-color: white;" class="spinner-border text-primary" role="status"-->
                      <!--                                                        *ngIf="Downloadloader"></i>&nbsp;&nbsp;-->
                      <c-spinner *ngIf="Downloadloader" aria-hidden="false" size="sm"></c-spinner>

                      Download
                    </button>
                  </div>
                </c-col>


                <c-col [md]="2">
                  <div style="padding-top: 25px;">
                    <button cButton type="reset" size="md" class="btn btn-info"
                            [disabled]="UploadTemplateForm?.invalid" (click)="GridData()">View
                    </button>
                  </div>
                </c-col>
                <c-col [md]="2">
                  <div style="padding-top: 25px;">
                    <button cButton type="reset" size="md" class="btn btn-danger"
                            (click)="resetAll()">Reset
                    </button>
                  </div>
                </c-col>
              </c-row>
            </form>

            <!--                <form [formGroup]="DownloadUploadForm" (keydown.enter)="$event.preventDefault()">-->
            <c-row>
              <c-col [md]="3">
                <h6>Upload Image</h6>
                <input aria-label="file example"
                       cFormControl
                       id="validationText1"
                       (change)="xlsxUpload($event)"
                       (selectionchange)="xlsxUpload($event)"
                       type="file"
                />
                <c-form-feedback [valid]="false">Example invalid form file feedback</c-form-feedback>
              </c-col>

              <c-col [md]="2" style="padding-top: 27px;">
                <button cButton type="button" class="btn btn-success"
                        (click)="Uploadfile()">
                  <!--                        <i style="border-color: white;" class="spinner-border text-primary" role="status"-->
                  <!--                           *ngIf="loader"></i>&nbsp;&nbsp;-->
                  <c-spinner *ngIf="loader" aria-hidden="false" size="sm"></c-spinner>

                  Upload
                </button>
              </c-col>
              <c-col [md]="2"></c-col>
              <!--                    <c-col [md]="2" style="padding-top: 30px;">-->
              <!--                      <button cButton type="submit" [disabled]="DownloadUploadForm?.invalid"-->
              <!--                              class="btn btn-success" (click)="Uploadfile()">-->
              <!--                        <i style="border-color: white;" class="spinner-border text-primary"-->
              <!--                           role="status" *ngIf="loader"></i>&nbsp;&nbsp;-->
              <!--                        <c-spinner  *ngIf="loader" aria-hidden="false" size="sm"></c-spinner>-->

              <!--                        Upload</button>-->
              <!--                    </div>-->
            </c-row>
            <!--                </form>-->
          </c-card-body>
          <c-card-body>
            <c-row>
              <c-col [md]="12" style="padding-top: 20px;">

                <c-input-group class="mb-3">
                  <span cInputGroupText id="basic-addon1">Search</span>
                  <input aria-describedby="basic-addon1"
                         aria-label="Username"
                         cFormControl
                         placeholder="Search here"
                         [(ngModel)]="searchValue"
                         (keyup)="quickSearch()"
                  />
                </c-input-group>
                <!--                    </form>-->
              </c-col>
            </c-row>
            <br/>
            <div>
              <div class="example-header">
                Page Size:
                <select
                  style="background-color: rgba(255, 255, 255, 0.1) !important;color: #495057; box-shadow: none; border-radius: 0.25rem; border: 1px solid #dde6e9;"
                  (change)="onPageSizeChanged()" id="page-size">
                  <option value="10" selected="">10</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                  <option value="500">500</option>
                  <option value="1000">1000</option>
                </select>
              </div>
              <br/>
              <ag-grid-angular style="width: 100%; height: 300px;" class="ag-theme-alpine"
                               [rowData]="rowss"
                               [gridOptions]="gridOptions"
                               [columnDefs]="columnDefs"
                               (gridReady)="onGridReady($event)"
                               (rowSelected)="onRowSelectedEvent($event)"
                               [pagination]="true"
                               [paginationPageSize]="paginationPageSize"
                               (selectionChanged)="onSelectionChanged($event)">
              </ag-grid-angular>
            </div>
          </c-card-body>
        </c-tab-pane>
        <c-tab-pane class="p-3">
          <c-card-body>
            <form cForm [formGroup]="DeleteTemplateForm" (keydown.enter)="$event.preventDefault()"
                  (ngSubmit)="OnDelete()">
              <c-row>
                <c-col [md]="4">
                  <label for="batchname">Batch:</label>
                  <div class="ng-autocomplete" style="width: 100%;">
                    <ng-autocomplete
                      id="batchname"
                      [data]="Batchs"
                      [searchKeyword]="Batchkeyword"
                      formControlName="batchname"
                      (selected)='selectBatch($event)'
                      (inputChanged)='onChangeSearch($event)'
                      (inputFocused)='onFocused($event)'
                      [itemTemplate]="batTemplate"
                      [notFoundTemplate]="notFoundTemplate"
                      placeholder="Select Batch">
                    </ng-autocomplete>

                    <ng-template #batTemplate let-bat>
                      <a [innerHTML]="bat.Batch_Name"></a>
                    </ng-template>

                    <ng-template #notFoundTemplate let-notFound>
                      <div [innerHTML]="notFound"></div>
                    </ng-template>
                    <span
                      *ngIf="DeleteTemplateForm.get('batchname')?.invalid && DeleteTemplateForm.get('batchname')?.touched"
                      class="text-danger">batch name is required</span>
                  </div>
                </c-col>

                <c-col [md]="2">
                  <label for="userexam">User Exam:</label>
                  <select [(ngModel)]="SelectedUserExam" formControlName="userexam"
                          class="form-control" (change)="onChangeUserExamSelect()">
                    <option selected>--Select User Exam--</option>
                    <option *ngFor="let user of namesubject" [ngValue]="user">
                      {{user.Userexamname}}</option>
                  </select>
                  <span
                    *ngIf="DeleteTemplateForm.get('userexam')?.invalid && DeleteTemplateForm.get('userexam')?.touched"
                    class="text-danger">user exam is required</span>
                </c-col>

                <c-col [md]="2" style="padding-top: 24px;">
                  <button cButton type="submit" [disabled]="DeleteTemplateForm?.invalid"
                          class="btn btn-success">Delete
                  </button>
                </c-col>
                <c-col [md]="1" style="padding-top: 24px;">
                  <button cButton type="submit" (click)="resetdelete()" class="btn btn-danger">Reset</button>
                </c-col>
              </c-row>
            </form>
          </c-card-body>
        </c-tab-pane>
      </c-tab-content>

    </c-card-body>
  </c-card>
</div>
