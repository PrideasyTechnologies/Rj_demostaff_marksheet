<div class="fade-in">
  <c-card>
    <c-card-header style="background-color:#f0f3f5">
      <h4><b>Upload DSE Subjects</b></h4>
    </c-card-header>
    <c-card-body>
      <c-nav variant="tabs">
        <c-nav-item>
          <a [active]="true"
             [cTabContent]="tabContent"
             [tabPaneIdx]="0" cNavLink>

            Roll Call List
          </a>
        </c-nav-item>
      </c-nav>
      <c-tab-content #tabContent="cTabContent">
        <c-tab-pane class="p-3">
          <form cForm [formGroup]="ShowForm" (keydown.enter)="$event.preventDefault()">
            <c-row>
              <c-col [md]="5">
                <label for="batch">Select Batch</label>
                <div id="batch" class="ng-autocomplete" style="width: 100%;">
                  <ng-autocomplete [data]="Batchs"
                                   [searchKeyword]="Batchkeyword"
                                   (selected)="selectBatch($event)"
                                   (inputChanged)="onChangeSearch($event)"
                                   (inputFocused)="onFocused($event)"
                                   [itemTemplate]="batTemplate"
                                   [notFoundTemplate]="notFoundTemplate"
                                   placeholder="Select Batch">
                  </ng-autocomplete>

                  <ng-template #batTemplate let-bat>
                    <a [innerHTML]="bat.Batch_Name"></a>
                  </ng-template>

                  <ng-template #notFoundTemplate let-notFound>
                    <div [innerHTML]="notFound"></div>
                  </ng-template>
                </div>
              </c-col>
              <c-col [md]="2">
                <label for="show">&nbsp;&nbsp; </label>
                <button cButton id="show" style="width: 100%" type="submit" class="btn btn-info"
                        (click)="Showexistingdata('SHOW')">
<!--                  <i style="border-color: white;" class="spinner-border text-primary" role="status"-->
<!--                     *ngIf="loader"></i>-->
                  <c-spinner  *ngIf="loader" aria-hidden="false" size="sm"></c-spinner>

                  Show
                </button>
              </c-col>

              <c-col [md]="2">
                <label for="download">&nbsp;&nbsp; </label>
                <button cButton id="download" type="submit" style="width: 100%" class="btn btn-info"
                        (click)="Showexistingdata('DOWNLOAD')">
<!--                  <i style="border-color: white;" class="spinner-border text-primary" role="status"-->
<!--                     *ngIf="loader"></i>&nbsp;&nbsp;-->
                  <c-spinner  *ngIf="loader" aria-hidden="false" size="sm"></c-spinner>

                  Download
                </button>
              </c-col>
            </c-row>

            <div class="d-grid gap-5">
              <div><br></div>
              <!--<div class="p-1 bg-white border">Grid item 2</div>
              <div class="p-2 bg-light border">Grid item 3</div>-->
            </div>
          </form>

          <form cForm [formGroup]="UploadForm" (keydown.enter)="$event.preventDefault()">
            <c-row>

              <c-col [md]="5">
                <h6>Upload Image</h6>
                <input aria-label="file example"
                       cFormControl
                       (change)="xlsxUpload($event)"
                       (selectionchange)="xlsxUpload($event)"
                       id="validationText1"
                       type="file"
                />
                <c-form-feedback [valid]="false">
                  Example invalid form file feedback
                </c-form-feedback>
              </c-col>


              <c-col [md]="2">
                <label for="btn_upload">&nbsp;&nbsp; </label>
                <button cButton id="btn_upload" style="width: 100% " type="button" class="btn btn-success"
                        (click)="OnUpload()">
<!--                  <i style="border-color: white;" class="spinner-border text-primary" role="status"-->
<!--                     *ngIf="Showuploadloader"></i>&nbsp;&nbsp;-->
                  <c-spinner  *ngIf="Showuploadloader" aria-hidden="false" size="sm"></c-spinner>

                  Upload
                </button>
              </c-col>
            </c-row>

          </form>

          <div class="d-grid gap-3">
            <div><br></div>
          </div>

          <div class="d-grid gap-3">
            <div><br></div>
          </div>

          <div>
            <ag-grid-angular style="width: 100%; height: 300px;" class="ag-theme-alpine"
                             [rowData]="rowdata"
                             [gridOptions]="gridOptions"
                             [columnDefs]="columnDefs"
                             (gridReady)="onGridReady($event)"
                             (rowSelected)="onRowSelectedEvent($event)"
                             (selectionChanged)="onSelectionChanged($event)">
            </ag-grid-angular>
          </div>
        </c-tab-pane>
      </c-tab-content>
    </c-card-body>
  </c-card>
</div>
